{"version":3,"file":"three-js-disposer.js","sources":["../node_modules/three-js-checker/src/three-check.js","../src/disposer.js","../src/check-wrapper.js"],"sourcesContent":["export function checkDependancy(packageName, dependancyName, dependancy) {\n    let duplicationMessage = `${packageName}: ${dependancyName} is duplicated. Your bundle includes ${dependancyName} twice. Please repair your bundle.`;\n    try {\n        if (THREE[dependancyName] === undefined) {\n            THREE[dependancyName] = dependancy;\n            return;\n        }\n\n        if (THREE[dependancyName] !== dependancy) {\n            throw duplicationMessage;\n        }\n    } catch (error) {\n        if (error !== duplicationMessage) {\n            console.warn(\n                `${packageName}: Duplication check unavailable.` + error\n            );\n        } else {\n            throw error;\n        }\n    }\n}\n\nexport function checkThreeRevision(packageName, revision) {\n    if (THREE.REVISION != revision) {\n        console.error(\n            `${packageName} depends on THREE revision ${revision}, but current revision is ${THREE.REVISION}.`\n        );\n    }\n}\n","\nconst THREE = require(\"three\");\n\nvar Disposer = function(){};\n\nDisposer.prototype.constructor = Disposer;\n\nDisposer.prototype.disposeOnCascade = (function(){\n    function disposeNode(node){\n        if (node instanceof THREE.Mesh)\n        {\n            if (node.geometry)\n            {\n                node.geometry.dispose();\n            }\n\n            if (node.material)\n            {\n                if (node.material && node.material.materials)\n                {\n                    for(var i=0;i<node.material.materials.length; ++i){\n                        mtrl = node.material.materials[i];\n                        if (mtrl.map)           mtrl.map.dispose();\n                        if (mtrl.lightMap)      mtrl.lightMap.dispose();\n                        if (mtrl.bumpMap)       mtrl.bumpMap.dispose();\n                        if (mtrl.normalMap)     mtrl.normalMap.dispose();\n                        if (mtrl.specularMap)   mtrl.specularMap.dispose();\n                        if (mtrl.envMap)        mtrl.envMap.dispose();\n\n                        mtrl.dispose();    // disposes any programs associated with the material\n                    }\n                }\n                else\n                {\n                    if (node.material.map)          node.material.map.dispose();\n                    if (node.material.lightMap)     node.material.lightMap.dispose();\n                    if (node.material.bumpMap)      node.material.bumpMap.dispose();\n                    if (node.material.normalMap)    node.material.normalMap.dispose();\n                    if (node.material.specularMap)  node.material.specularMap.dispose();\n                    if (node.material.envMap)       node.material.envMap.dispose();\n\n                    node.material.dispose ();   // disposes any programs associated with the material\n                }\n            }\n        }\n    }   // disposeNode\n\n    function disposeHierarchy (node, callback){\n        for (var i = node.children.length-1; i>=0; i--){\n            var child = node.children[i];\n            disposeHierarchy (child, callback);\n            callback (child);\n        }\n    }\n\n    return function(o){\n        disposeHierarchy(o, disposeNode);\n    };\n\n})();\n\nmodule.exports = Disposer;","/*\n * This file encapsulates the xthree library.\n * It checks if the needed three examples and the library are duplicated.\n */\nimport { checkDependancy, checkThreeRevision } from \"three-js-checker\";\n\n// Duplication check\n\nimport {Disposer} from \"./exports.js\";\n\nconst PACKAGE_NAME = \"three-js-disposer\";\n\ncheckThreeRevision(PACKAGE_NAME, 130);\ncheckDependancy(PACKAGE_NAME, \"Disposer\", Disposer);\n\n// Reexport API\n\nexport * from \"./exports\";\n"],"names":["THREE","require$$0","Disposer"],"mappings":"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"}